# i3 config file (v4)
#
# Please see http://i3wm.org/docs/userguide.html for a complete reference!

set $mod Mod4

# Font for window titles. Will also be used by the bar unless a different font
# is used in the bar {} block below.
font pango:Source Code Pro 11

new_window 1pixel
new_float 1pixel

# Use Mouse+$mod to drag floating windows to their wanted position
floating_modifier $mod

focus_follows_mouse no
hide_edge_borders both

# start a terminal
bindsym $mod+t exec i3-sensible-terminal

# kill focused window
bindsym $mod+Shift+q kill

# start dmenu (a program launcher)
#bindsym $mod+space exec --no-startup-id i3-dmenu-desktop
bindsym $mod+space exec rofi -show run -bg "#222222" -fg "#2ECC71" -hlbg "#445544" -hlfg "#2EEE71" -bw 4 -eh 1 -opacity "80" -lines 8 -line-margin 4 -width 100 -padding 160 -terminal terminator

#Move focus:
bindsym $mod+Left focus left
bindsym $mod+Down focus down
bindsym $mod+Up focus up
bindsym $mod+Right focus right

# alternatively, you can use the cursor keys:
bindsym $mod+Ctrl+Left move left
bindsym $mod+Ctrl+Down move down
bindsym $mod+Ctrl+Up move up
bindsym $mod+Ctrl+Right move right

# split in horizontal orientation
bindsym $mod+Shift+h split h

# split in vertical orientation
bindsym $mod+Shift+v split v

# enter fullscreen mode for the focused container
#bindsym $mod+Shift+f fullscreen toggle
bindsym F11 fullscreen toggle

# change container layout (stacked, tabbed, toggle split)
bindsym $mod+Shift+t layout toggle all
#bindsym $mod+Shift+a layout stacking
#bindsym $mod+Shift+t layout tabbed
#bindsym $mod+Shift+s layout toggle split

# toggle tiling / floating
bindsym $mod+Shift+space floating toggle

# change focus between tiling / floating windows
#bindsym $mod+space focus mode_toggle

# focus the parent container
#bindsym $mod+u focus parent

# focus the child container
#bindsym $mod+d focus child

# Workspace variables
set $WS1 web
set $WS2 term
set $WS3 misc

# switch to workspace
bindsym $mod+1 workspace $WS1
bindsym $mod+2 workspace $WS2
bindsym $mod+3 workspace $WS3

# move focused container to workspace
bindsym $mod+Shift+1 move container to workspace $WS1
bindsym $mod+Shift+2 move container to workspace $WS2
bindsym $mod+Shift+3 move container to workspace $WS3

# task switcher - rofi
bindsym Mod1+Tab \
  exec rofi \
  -show window -terminal terminator -hide-scrollbar true  \
  -line-margin 0 -lines 20 -eh 1 -width 40 -bw 3 \
#  -kb-mode-next      Alt+Tab \
#  -kb-mode-previous  Alt+Shift+Tab \
  -bg        "#222222"  -fg        "#2ECC71" \
  -hlbg      "#2ECC71"  -hlfg      "#222222" \
  -bg-active "#222222"  -fg-active "#2288DD" \
  -opacity 80

# reload the configuration file
bindsym $mod+Shift+c reload

# restart i3 inplace (preserves your layout/session, can be used to upgrade i3)
bindsym $mod+Shift+r restart

# exit i3 (logs you out of your X session)
bindsym $mod+Shift+x exec "i3-nagbar -t warning -m 'You pressed the exit shortcut. Do you really want to exit i3? This will end your X session.' -b 'Yes, exit i3' 'i3-msg exit'"

# resize window (you can also use the mouse for that)
# Pressing left will shrink the window’s width.
# Pressing right will grow the window’s width.
# Pressing up will shrink the window’s height.
# Pressing down will grow the window’s height.

bindsym $mod+Mod1+Left resize shrink width 10 px or 10 ppt
bindsym $mod+Mod1+Down resize grow height 10 px or 10 ppt
bindsym $mod+Mod1+Up resize shrink height 10 px or 10 ppt
bindsym $mod+Mod1+Right resize grow width 10 px or 10 ppt

# --- custom --- #

## utilities

# screenshot

bindsym $mod+Shift+0 exec --no-startup-id notify-send "scrot" "\nTaking a screenshot..." -t 3000 && scrot
bindsym $mod+0 --release exec --no-startup-id notify-send "scrot" "\nSelect a rectangle to save..." -t 3000 && scrot -s '%Y-%m-%d--%s_$wx$h_scrot.png' -e 'mv $f ~/ '

# screen lock

# default setup
# bindsym $mod+control+l exec --no-startup-id i3lock -c 000000
# exec_always --no-startup-id xautolock -time 15 -locker "i3lock -c 000000"
#   or
# use a script to control the locking
bindsym $mod+Shift+l exec --no-startup-id slock

# multimedia keys

bindsym XF86AudioRaiseVolume exec "amixer -D pulse sset Master '5%+'"
bindsym XF86AudioLowerVolume exec "amixer -D pulse sset Master '5%-'"
bindsym XF86AudioMute exec "amixer -D pulse set Master toggle"
bindsym XF86AudioMicMute exec "amixer -D pulse sset Capture toggle"

# scratchpad / sticky windows

# move the currently focused window to the scratchpad
#bindsym $mod+Shift+minus move scratchpad; sticky enable
#bindsym $mod+F12 move scratchpad; sticky enable

# show the next scratchpad window or hide the focused scratchpad window.
# If there are multiple scratchpad windows, this command cycles through them.
#bindsym $mod+minus scratchpad show
#bindsym F12 scratchpad show

# make current window sticky
bindsym $mod+Shift+s sticky toggle

## workspace 

# set automatic back and forth
workspace_auto_back_and_forth yes
# toggle between last two workspaces
bindsym $mod+Shift+z workspace back_and_forth

# move to left and right workspaces
bindsym $mod+Shift+Tab workspace prev
bindsym $mod+Tab workspace next

# move a window to the adjacent workspaces
bindsym $mod+Shift+Right move container to workspace next; workspace next
bindsym $mod+Shift+Left move container to workspace prev; workspace prev

# use numpad for workspace switching
bindsym KP_1 workspace $WS1
bindsym KP_2 workspace $WS2
bindsym KP_3 workspace $WS3

# move focused container to workspace bindsym $mod+Shift+1 move container to workspace 1
#bindsym Shift+KP_1 move container to workspace $WS1; workspace $WS1

## windows

# floating window preferences
floating_minimum_size 100 x 100
floating_maximum_size 1500 x 1500

# toggle borders and bar mode (hide or show)
bindsym $mod+Shift+b bar mode toggle
bindsym $mod+Shift+o border toggle

# floating rules

# set all preference and settings windows to float
for_window [title="Preferences$"] floating enable
for_window [title="Settings$"] floating enable


## application shortcuts

# audio mixer
#bindsym $mod+a exec --no-startup-id terminator -e alsamixer
#for_window [title="alsamixer$"] floating enable

# system monitor
#bindsym $mod+Delete exec --no-startup-id terminator -e htop
#for_window [title="htop$"] floating enable

# web browser
bindsym $mod+w exec --no-startup-id i3-msg 'workspace $WS1; firefox'

# mail client
bindsym $mod+m exec --no-startup-id i3-msg 'workspace $WS1; firejail --seccomp thunderbird'

# file manager
bindsym $mod+f exec --no-startup-id thunar

# text editor
bindsym $mod+z exec --no-startup-id i3-msg 'workspace $WS1; subl'

# colors
# class                 border  backgr. text    indicator
client.focused              $ac        $ac         $tx
client.unfocused            $bg        $bg         $ac
client.focused_inactive     $bg        $bg         $ac
client.urgent               $rd        $rd         $tx
client.background #ffffff


## autostart

#if xrandr -q | grep -q "VGA1 connected" ; then
#    ~/.screenlayout/vga1.sh
#fi

#if xrandr -q | grep -q "HDMI1 connected" ; then
#    ~/.screenlayout/hdmi1.sh
#fi

exec_always --no-startup-id udiskie &
exec_always --no-startup-id syndaemon -i 2 -d &

exec_always --no-startup-id nitrogen --restore &
exec_always --no-startup-id numlockx &
# Launch compton and tint2 with openbox
#if which tint2 >/dev/null 2>&1; then
exec_always --no-startup-id   compton --config ~/.config/compton.conf -b
  #tint2 &
#fi

exec_always --no-startup-id volumeicon &
exec_always --no-startup-id redshift -O 3800 &

# set speaker to 100% since pulseaudio doesn't keep the change each time :/

exec_always --no-startup-id amixer set Speaker 100% &

exec_always --no-startup-id qxkb &

# sigh, pulseaudio ...
exec_always --no-startup-id (sleep 2s && killall pulseaudio) &

# setup auto screen lock after 15 minutes
exec_always --no-startup-id xautolock -time 15 -locker "slock"


# --- i3bar --- #


#### i3status bar  ####
# Start i3bar to display a workspace bar (plus the system information i3status
# finds out, if available)
# bar {
#     colors {
#         background #000000
#         statusline #00A5FF #that neon blue
#         separator #999999
# 
#         focused_workspace  #4c7899 #285577 #ffffff
#         active_workspace   #333333 #5f676a #ffffff
#         inactive_workspace #333333 #222222 #888888
#         urgent_workspace   #2f343a #900000 #ffffff
#     }
#     
#     #status_command i3status -c /etc/i3status.conf
#     status_command i3status -c ~/.config/i3/i3status.conf
#     status_command i3status
#     position bottom
#     tray_output primary
#     tray_padding 0
#     separator_symbol "]["
# }


#### i3blocks bar ####

bar {
    colors {
        background #000000
        statusline #00A5FF #that neon blue
        separator #999999

        focused_workspace  #4c7899 #285577 #ffffff
        active_workspace   #333333 #5f676a #ffffff
        inactive_workspace #333333 #222222 #888888
        urgent_workspace   #2f343a #900000 #ffffff
    }
    
    status_command i3blocks -c ~/.config/i3blocks/config
    position bottom
    tray_output primary
    tray_padding 0
    separator_symbol "]["
}
